package ru.cryhards.brootkiddie.malware


import com.badlogic.gdx.Gdx
import ru.cryhards.brootkiddie.Player
import ru.cryhards.brootkiddie.malware.scripts.Script


abstract class Malware(val name: String, val player : Player) {
    var scripts = emptyList<Script>()

    var infectiousness = 0f
    var speed = 0f
    var irritation = 0f
    var capacity = 10
    var cryptoMiningSpeed = 0f

    fun addScript(script: Script) {
        script.attach(this)
        scripts += script

        recalcStats()
    }

    fun getSize(): Int {
        val size = scripts.sumBy { it.getSize() }
        return size
    }

    open fun recalcStats() {
        infectiousness = 0f
        speed = 0f
        cryptoMiningSpeed = 0f
        irritation = getSize() / capacity.toFloat()

        for (script in scripts) {
            script.act()
        }

        Gdx.app.log("Malware", name)
    }
}